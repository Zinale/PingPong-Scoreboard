<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Ping Pong Scoreboard</title>
    <link rel="icon" href="{{ url_for('static', filename='icons/favicon.png') }}">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: #f0f0f0;
        }
        h1 { font-size: 3em; }
        .score {
            font-size: 5em;
            margin: 20px;
        }
        button {
            font-size: 2em;
            padding: 15px 25px;
            margin: 5px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }
        .a { background: #ff4d4d; color: white; }
        .b { background: #4da6ff; color: white; }
        .reset { background: #888; color: white; }
        .minus { background: #ffa64d; color: white; }
    </style>
</head>
<body>
    <h1>üèì Ping Pong</h1>

    <div class="score" id="score_a">0</div>
    <button class="a" onclick="updatePoint('a', 1)">+1 Giocatore A</button>
    <button class="minus" onclick="updatePoint('a', -1)">-1 Giocatore A</button>

    <div class="score" id="score_b">0</div>
    <button class="b" onclick="updatePoint('b', 1)">+1 Giocatore B</button>
    <button class="minus" onclick="updatePoint('b', -1)">-1 Giocatore B</button>

    <br><br>
    <button class="reset" onclick="resetScore()">Reset</button>

    <audio id="sound_a_plus" src="{{ url_for('static', filename='sounds/plus_a.mp3') }}"></audio>
    <audio id="sound_a_minus" src="{{ url_for('static', filename='sounds/minus_a.mp3') }}"></audio>
    <audio id="sound_b_plus" src="{{ url_for('static', filename='sounds/plus_b.mp3') }}"></audio>
    <audio id="sound_b_minus" src="{{ url_for('static', filename='sounds/minus_b.mp3') }}"></audio>

<script>
    const socket = io();

    let lastScore = {a: 0, b: 0};

    function updatePoint(player, change) {
        socket.emit("update_point", { player, change });
    }

    function resetScore() {
        socket.emit("reset_score");
    }

    socket.on("update_score", (data) => {
        document.getElementById("score_a").textContent = data.a;
        document.getElementById("score_b").textContent = data.b;

        let deltaA = data.a - lastScore.a;
        let deltaB = data.b - lastScore.b;

        if (deltaA > 0) playSound("a_plus");
        else if (deltaA < 0) playSound("a_minus");

        if (deltaB > 0) playSound("b_plus");
        else if (deltaB < 0) playSound("b_minus");

        lastScore = data;
    });

    function playSound(id) {
        const audio = document.getElementById("sound_" + id);
        if (audio) {
            audio.currentTime = 0;
            audio.play();
        }
    }
</script>
</body>
</html>
